<!DOCTYPE html>
<html lang="en">

<head>
    <script src='https://d3js.org/d3.v7.min.js'></script>
</head>

<body>
</body>

<style>
    svg rect {
        fill: blue;
    }

    svg text {
        fill:white;
        font: 10px sans-serif;
        text-anchor: end;
    }
</style>

<script>
    // // importing the csv file
    let heartfailurecsv = 'https://raw.githubusercontent.com/akmand/datasets/master/heart_failure.csv';

    var ticks = [1,30,40,60,100]
    var counts = []

    // // reading the csv file
    d3.csv(heartfailurecsv).then(function(data) {

        // filter the data for only people who had died
        filtered = data.filter(function(d){
            return d.DEATH_EVENT == 1
        })

        for (var i = 0; i < filtered.length; i++) {
                // the key of counts object is based off the array parameter provided and increment the count
                counts[i] = parseInt(filtered[i].age)
        };

        console.log(d3.max(ticks))
        console.log(typeof ticks[0])

        var width = 200;
        var scaleFactor = 10;
        var barHeight = 20;

        var graph = d3.select("body")
            .append("svg")
            .attr("width", width)
            .attr("height", barHeight * counts.length);

        var bar = graph.selectAll("g")
                        .data(counts)
                        .enter()
                        .append("g")
                        .attr("transform", function(d, i) {
                            return "translate(0," + i * barHeight + ")";
                        });

        bar.append("rect")
            .attr("width", function(d) {
            return d * scaleFactor;
            })
            .attr("height", barHeight - 1);

        bar.append("text")
            .attr("x", function(d) { return (d*scaleFactor); })
            .attr("y", barHeight / 2)
            .attr("dy", ".35em")
            .text(function(d) { return d; });

        // var histo = d3.layout.histogram()
        //                         .bins(ticks)
        //                         (counts);

        // var margin = {
        //     top: 30,
        //     right: 30,
        //     bottom: 30,
        //     left: 30
        // },
        // width = 960 - margin.left - margin.right,
        // height = 500 - margin.top - margin.bottom;

        // var x = d3.scale.linear()
        //         .domain([0, d3.max(ticks)])
        //         .range([0, width]);

        // var y = d3.scale.linear()
        //         .domain([0, d3.max(histo, function(d) {
        //             return d.y;
        //         })])
        //         .range([height, 0]);

        // var xAxis = d3.svg.axis()
        //             .scale(x)
        //             .orient("bottom")
        //             .tickValues(ticks)

        // var svg = d3.select("body").append("svg")
        //             .attr("width", width)
        //             .attr("height", height)
        //             .append("g")
        //             .attr("transform", "translate(" + margin.left + "," + margin.top + ")");

        // var bar = svg.selectAll(".bar")
        //             .data(histo)
        //             .enter().append("g")
        //             .attr("class", "bar")
        //             .attr("transform", function(d) {
        //                 return "translate(" + x(d.x) + "," + y(d.y) + ")";
        //             });

        // bar.append("rect")
        // .attr("x", 1)
        // .attr("width", x(data[0].dx) - 1)
        // .attr("height", function(d) {
        //     return height - y(d.y);
        // });

        // //this block of code makes the tick values showing how many fall into the bin
        // bar.append("text")
        // .attr("dy", ".75em")
        // .attr("y", 6)
        // .attr("x", x(histo[0].dx) / 2)
        // .attr("text-anchor", "middle")
        // .text(function(d) {
        //     return d;
        // });

        // svg.append("g")
        // .attr("class", "x axis")
        // .attr("transform", "translate(0," + height + ")")
        // .call(xAxis);

    });

</script>

</html>